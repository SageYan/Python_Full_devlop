[TOC]

# python小数据池，代码块的最详细、深入剖析

## id  is  ==

```python
1 在Python中，id是内存地址
name = 'sage'
print(id(name),id('sage'))
结果：
2567579349992 2567579349992

2 == 是比较的两边的数值是否相等，而 is 是比较的两边的内存地址是否相等。 如果内存地址相等，那么这两边其实是指向同一个内存地址。

l1 = 'sage'
l2 = 'sage'
print(l1 is l2,l1 == l2)

l3 = [1,2,3]
l4 = [1,2,3]
print(l3 is l4,l3 == l4)
结果：
True True
False True

```

## 代码块

```python
Python程序是由代码块构造的。块是一个python程序的文本，他是作为一个单元执行的。
代码块：一个模块，一个函数，一个类，一个文件等都是一个代码块。
而作为交互方式输入的每个命令都是一个代码块。
```

### 代码块的缓存机制

#### 前提条件：在同一个代码块内

```python
#机制内容
​```
执行同一个代码块时，遇到初始化对象的命令时，他会将初始化的这个变量与值存储在一个字典中，在遇到新的变量时，会先在字典中查询记录，如果有同样的记录那么它会重复使用这个字典中的之前的这个值
​```

#适用对象： int（float），str，bool
​```
int(float):任何数字在同一代码块下都会复用。
bool:True和False在字典中会以1，0方式存在，并且复用。
str：几乎所有的字符串都会符合缓存机制，具体规定如下：
	1 非乘法得到的字符串都满足代码块的缓存机制
    s1 = '太白@！#*ewq'
    s2 = '太白@！#*ewq'
    print(s1 is s2)  # True
    2 乘法得到的字符串分两种情况:
        2.1 乘数为1时，任何字符串满足代码块的缓存机制
        b1 = '太白@5847395QQ0743895*&^%$#((&_+(())' *1
        a1 = '太白@5847395QQ0743895*&^%$#((&_+(())' *1
        print(a1 is b1)  # True
        2.2乘数>=2时：仅含大小写字母，数字，下划线，总长度<=20，满足代码块的缓存机制：
        s1 = 'old_' * 5
        s2 = 'old_' * 5
        print(s1 is s2)  # True
        
​```
#优点：能够提高一些字符串，整数处理在时间和空间上的性能；需要值相同的字符串，整数的时候，直接从‘字典’中取出复用，避免频繁的创建和销毁，提升效率，节约内存。
```

#### 前提条件：在不同一个代码块内（小数据池）

```python
# 机制内容
​```
Python自动将-5~256的整数进行了缓存，当你将这些整数赋值给变量时，并不会重新创建对象，而是使用已经创建好的缓存对象。

python会将一定规则的字符串在字符串驻留池中，创建一份，当你将这些字符串赋值给变量时，并不会重新创建对象， 而是使用在字符串驻留池中创建好的对象。
​```

#适用对象  int（float），str，bool 
​```
int：那么大家都知道对于整数来说，小数据池的范围是-5~256
str:
    1 字符串的长度为0或者1，默认都采用了驻留机制（小数据池）
    2 字符串的长度>1,且只含有大小写字母，数字，下划线时，才会默认驻留
    3 用乘法得到的字符串，分两种情况
    	3.1 乘数为1时：仅含大小写字母，数字，下划线，默认驻留
        3.2 乘数>=2时：仅含大小写字母，数字，下划线，总长度<=20,默认驻留
bool: 0,1

指定驻留:
from sys import intern
a = intern('hello!@'*20)
b = intern('hello!@'*20)
print(a is b)
----指定驻留是你可以指定任意的字符串加入到小数据池中，让其只在内存中创建一个对象，多个变量都是指向这一个字符串
​```
```



